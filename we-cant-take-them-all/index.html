<html>

<head>

  </head>

<body>

<button type="button" id="german" onclick="oppositionVoiced(this.id)">I am German and I don't think that we should admit any more Afghans.</button><br>
<button type="button" id ="finnish" onclick="oppositionVoiced(this.id)">I am Finnish and I don't think that we should admit any more Somalis.</button><br>
<button type="button" id="english" onclick="oppositionVoiced(this.id)">I am English and I don't think that we should admit any more Romanians.</button><br>
<button type="button" id="american" onclick="oppositionVoiced(this.id)">I am American and I don't think that we should admit any more Mexicans.</button>

  <p id="p2"> </p>


<script>

var information = "This is a combinatory artwork based on a text written by professor of Political Science Joseph Carens. " +
"Joseph Carens wrote this text as a generalisation of sentiments by those opposed to admitting Jewish refugees into America during world war II." +
"The purpose of this piece is to raise awareness about the similarities in discourse utilised across various instances of anti refugee logic."

//select sentences which fit together quite nicely.
//and make four different states, ie. that combine These
//for example: "what is happening.. is too bad.. we have our own problems"
//plus a random sentence
//Or: Times are tough here, we have an obligation to look out for our own needy first
//and then something else.
//I need to think about this a little bit more...

var carensGeneralisation = [
"What is happening to the Jews is too bad, but it's not our fault. " +
"We have our own problems. ",
"If we take in all the Jews who want to come, we will be overwhelmed. " +
"There are simply too many of them. ",
"Besides, while Jews may be subject to discrimination and occasional acts of violence, things re not as bad as their advocacy groups say. " +
"They exaggerate the problem. ",
"Many of the Jews really just want better economic opportunities than they have now at home. " +
"In fact, the ones who do manage to make it to North America to seek asylum cannot be among the worst off because they have enough economic resources to cross the Atlantic. ",
"Times are tough here. " +
"We have an obligation to look out for our own needy first. ",
"A large infux of Jews could be a cultural and political threat. " +
"They don't share our religious traditions or our democractic values. ",
"Some of them are communists and pose a basic security threat, but it's hard to be sure which ones, so it's better to err on the side of caution in restricting entry. ",
"Many of them have shown that they don't really respect the law because they have bribed officials abroad for exit permits and travel papers, they have purchased forged documents, they have hired smugglers to transport them illegally, and they have lied to our immigration officials. ",
"Admitting Jewish refugees does not help to address the underlying problems that have given rise to the Nazi phenomenon."
];

console.log(carensGeneralisation);

var me = {};
var refugees = {};
var refugeeSituation = {};

//me = {nationality:"", scaryOther:""};
//refugees = {nationality:"", opressor:"", geographicalObstacle:"", promisedLand:""};

//refugeeSituation = {me: me, refugees: refugees};

//var someRefugeeSituations = {};

me = {nationality:"german",scaryOther:"muslim extremists"};
refugees = {nationality:"Afghan", opressor:"taleban", geographicalObstacle:"Mediterranean", promisedLand:"Germany"};
refugeeSituation = {me: me, refugees: refugees};

var synth = window.speechSynthesis;
var speakThis = new SpeechSynthesisUtterance;
//speakThis.lang = setLanguage();
speakThis.text = '';



/*
someRefugeeSituations = {
  situation1: {me:{nationality:"german",scaryOther:"muslim extremists"},refugees:{nationality:"Afghans", opressor:"taleban", geographicalObstacle:"Mediterranean", promisedLand:"Germany"}},
  me:{nationality:"finnish",scaryOther:"muslim extremists"},refugees:{nationality:"Somalis", opressor:"boko haram", geographicalObstacle:"Sahara", promisedLand:"Finland"},
  me:{nationality:"english",scaryOther:"criminals"},refugees:{nationality:"Romanians", opressor:"corrupt government", geographicalObstacle:"English channel", promisedLand:"England"},
  me:{nationality:"american",scaryOther:"criminals"},refugees:{nationality:"Venezuelans", opressor:"Maduro regime", geographicalObstacle:"The Mexican border", promisedLand:"America"}
};

console.log(someRefugeeSituations.situation1.me + "<br>" + someRefugeeSituations[3].refugees.opressor);
/*

/*
var someSampleRefugeeSituations{
  {nationalityMe:"german", nationalityRefugees:"Afghans", promisedLand:"Germany", geographicalObstacle:"Mediterranean", scaryOther:"extremists", opressor:"taleban"},
  {nationalityMe:"finnish", nationalityRefugees:"Somalis", promisedLand:"Finland", geographicalObstacle:"Sahara", scaryOther:"extremists", opressor:"boko haram"},
  {nationalityMe:"english", nationalityRefugees:"Romanians", promisedLand:"England", geographicalObstacle:"English channel", scaryOther:"criminals", opressor:"corrupt government"},
  {nationalityMe:"american", nationalityRefugees:"Venezuelans", promisedLand:"America", geographicalObstacle:"the Mexican border", scaryOther:"criminals", opressor:"Maduro regime"}
};
*/

function oppositionVoiced(myNationality){
  //nationality becomes the voice of the speechSynthesizer;
  //depending on nationality, we replace the variables refugeeNationality, promisedLand, geographicObstacle, scaryOther, opressor;
  //these should all exist in an array identified by the nationality of the local who is opposed to refugees.

  //me.nationality = myNationality;

  var myFullandHonestOpinion = replaceCarensGeneralisationWith(refugeeSituation);
  //var myBriefOpinion = chooseSomeSentencesFrom(myFullandHonestOpinion);
  speakMyOpinion(me.nationality, myFullandHonestOpinion);

/*
  for(i=0; i<someRefugeeSituations.length; i++){
    if(me.nationality == someRefugeeSituations[i].me.nationality){
      var oneRefugeeSituation = someRefugeeSituations[i];
      populateTheRefugeeSituation(oneRefugeeSituation);
      var myOpinion = replaceCarensGeneralisationWith(refugeeSituation);
      speakMyOpinion(me.nationality, myOpinion);
    }
  }*/

  function populateTheRefugeeSituation(sampleRefugeeSituation){
    me.nationality = sampleRefugeeSituation.me.nationality;
    me.scaryOther = sampleRefugeeSituation.me.scaryOther;
    refugees.nationality = sampleRefugeeSituation.refugees.nationality;
    refugees.opressor = sampleRefugeeSituation.refugees.opressor;
    refugees.geographicalObstacle = sampleRefugeeSituation.refugees.geographicalObstacle;
    refugees.promisedLand = sampleRefugeeSituation.refugees.promisedLand;
    refugeeSituation = {me, refugees};
  };//end of populateTheRefugeeSituation

  function replaceCarensGeneralisationWith(refugeeSituation){
    var myOpinion = [];
    //we need to create a for loop that loops through carensGeneralisation
    //and replaces elements in the strings at each index
    for (var i = 0; i < carensGeneralisation.length; i++) {
      myOpinion[i] = carensGeneralisation[i].replace("Jewish", refugeeSituation.refugees.nationality);
      myOpinion[i] = myOpinion[i].replace(/Jew/g, refugeeSituation.refugees.nationality);
      myOpinion[i] = myOpinion[i].replace("North America", refugeeSituation.refugees.promisedLand);
      myOpinion[i] = myOpinion[i].replace("Atlantic", refugeeSituation.refugees.geographicalObstacle);
      myOpinion[i] = myOpinion[i].replace("communists", refugeeSituation.me.scaryOther);
      myOpinion[i] = myOpinion[i].replace(/Nazi/g, refugeeSituation.refugees.opressor);
      console.log(myOpinion[i]);
    }//end of replaceCarensGeneralisationWith

    /* this is old code for replacing elements in what used to be just a huge string
    and is now an array
    myOpinion = carensGeneralisation.replace(/Jew/g, refugeeSituation.refugees.nationality);//global replace of all instances of Jews
    console.log("Opinion is: " + myOpinion);
    myOpinion = myOpinion.replace("Jewish", refugeeSituation.refugees.nationality);//global replace of all instances of Jews
    console.log("Opinion is: " + myOpinion);
    myOpinion = myOpinion.replace("North America", refugeeSituation.refugees.promisedLand);
    console.log("Opinion is: " + myOpinion);
    myOpinion = myOpinion.replace("Atlantic", refugeeSituation.refugees.geographicalObstacle);
    console.log("Opinion is: " + myOpinion);
    myOpinion = myOpinion.replace("communists", refugeeSituation.me.scaryOther);
    console.log("Opinion is: " + myOpinion);
    myOpinion = myOpinion.replace(/Nazi/g, refugeeSituation.refugees.opressor);//global replace of all instances of Nazi
    console.log("Opinion is: " + myOpinion);
    return myOpinion;*/

    return myOpinion;
  };

  function speakMyOpinion(language, opinion){
    console.log("Language is: " + language + " and opinion is: " + opinion);

    var opinions = opinion.split(". ");
    console.log(opinions);


    var someOpinions = "";

    someOpinions = selectSentences(opinions);

    function selectSentences(opinions){
      //there are 16 possible sentences. Select three or four sentences.
      //This makes it seem like the text is new or different every time
      //...for the first few times ;-))))))
      var indices = makeRandomIndices(opinions);

      function makeRandomIndices(opinions){
        var index;
        var randomIndices = [];
        for(i=1; i<=1;i++){//2 is the number of sentences we want
          index = Math.floor((Math.random() * opinions.length-1) + 1);
          randomIndices.push(index);
          console.log("This is the random index: " + index);
        }
        console.log("These are the random indices: " + randomIndices);
        return randomIndices;
      }

      var randomOpinion = "";
      randomOpinion = constructOpinion(opinions, indices);

      function constructOpinion(opinions, indices){
        var newOpinion = "";
        newOpinion += opinions[0] + ". ";//always starts with "What is happening..."
        for(i=0;i<=0;i++){//two sentences
          newOpinion += opinions[indices[i]] + ". ";
          console.log("Random opinion is:" + newOpinion);
        }
        return newOpinion;
      }

/*
      var newOpinion = "";
      var counter = 0;
      console.log("We made it to selectSentences()");
      for(i=0; counter<=3; i++){
        randomNumber = Math.floor((Math.random() * 10) + 1);
        console.log("Random number is:" + randomNumber);
        if(randomNumber>5){
          newOpinion += opinions[i] + ". ";
          counter++;
          console.log("Selected sentence is:" + opinions[i] + "and counter is: " + counter);
        }else{
          console.log("No sentence selected.");
        }
      }
      console.log("Selected sentences are:" + newOpinion);
      return newOpinion;*/



    speakThis.lang = "de-DE";
    speakThis.text = randomOpinion;
    synth.speak(speakThis);

    speakThis.onend = function(event) {
      document.getElementById("p2").innerHTML = "";
      console.log('deleting text content');
  console.log('Utterance has finished being spoken after ' + event.elapsedTime + ' milliseconds.');
}

    //document.body.innerHTML.insertAdjacentText(opinion);

    var para = document.createElement("p");
    var node = document.createTextNode(randomOpinion);
    para.appendChild(node);

    //var element = document.getElementById("transcriptDiv");
    //element.appendChild(para);

    console.log('adding text content to p2');
    document.getElementById("p2").innerHTML = para.innerHTML;
    console.log('added text content to p2');




};

  };

}//end of oppositionVoiced





</script>

</body>


</html>
